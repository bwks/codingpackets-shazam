



<!DOCTYPE html>
<html lang="en" class="dark scroll-smooth scroll-pt-[4.5rem]">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
      <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
    
    
    
      <link rel="stylesheet" href="/css/highlightjs/highlightjs-xt256.css">
      <link rel="stylesheet" href="/css/fontawesome/css/all.min.css">
    

    
      <link rel="stylesheet" href="/css/app.css">
    

    
      <script src="/js/highlightjs/highlightjs-11.5.0.min.js"></script>
      <script src="/js/highlightjs/terraform.js"></script>
      <script defer src="/js/fontawesome/js/all.js"></script>
    

    
      <script defer src="/js/custom/back-to-top.js"></script>
      <script defer src="/js/custom/light-switch.js"></script>
    

    
      <script>
        hljs.registerLanguage('terraform', window.hljsDefineTerraform);
        hljs.highlightAll();
      </script>
    

    
    

    <title>codingpackets.com</title>
  </head>

  <body class="bg-stone-50 dark:bg-black tracking-wide ">

    <!-- NAVBAR START -->
<nav id="navbar" class="w-full py-3 bg-zinc-900 text-xl shadow-lg fixed inset-x-0 top-0 z-50">
  <div class="flex justify-center items-center py-1">
    <div>
      <a class="text-neutral-400 hover:text-neutral-100 p-0" href="/">Me</a>
    </div>
    <div class="px-4">
      <p class="text-neutral-400 p-0">|</p>
    </div>
    <div>
      <a class="text-neutral-400 hover:text-neutral-100" href="/blog/">Blog</a>
    </div>
    <div class="px-4">
      <p class="text-neutral-400 p-0">|</p>
    </div>
    <div>
      <a class="text-neutral-400 hover:text-neutral-100" href="/blog/recent/">Recent</a>
    </div>
    <div class="px-4">
      <p class="text-neutral-400 p-0">|</p>
    </div>
    <div class="-mt-6 -ml-1">
      <labeL class="relative inline-block">
        <input type="checkbox" id="light-switch" class="opacity-0 w-0 h-0">
        <img id="light-bulb" class="opacity-90 hover:opacity-60 dark:opacity-60 dark:hover:opacity-100 p-0 w-7" src="/img/light-bulb-64-light.png" alt="on/off">
      </labeL>
    </div>
  </div>  
</nav>
<!-- NAVBAR END -->

    <div class="w-full">
      
  
    
<!-- PAGE HEADER START -->
<div class="grid grid-cols-12 gap-8">
  <div class="invisible md:visible md:col-span-3">
  </div>

  <div class="col-span-12 px-5 md:col-span-6">
    <div id="page-header" class="pt-20 -mb-4 pb-0 px-5 text-center sm:pb-4 sm:mb-0">
      <h1 class="pb-1 sm:pb-2">ExtraHop Bridge Triggers</h1>
      <div class="">
        
        
          <p class="text-neutral-500 dark:text-neutral-600 text-lg italic p-0">
            published: 27th of February 2022
          </p>
        
      </div>
    </div>
  </div>

  <div class="invisible md:visible md:col-span-3">
  </div>
</div>
<!-- PAGE HEADER END -->

  


      <!-- CONTENT START -->
      <div class="grid grid-cols-12 gap-8">

        <!-- COLUMN 1 START -->
        <div class="invisible md:visible md:col-span-3">
        </div>
        <!-- COLUMN 1 END -->

        <!-- COLUMN 2 START -->
        <div class="col-span-12 px-5 md:col-span-6">
          <div class="text-xl text-gray-800 dark:text-neutral-400 font-medium leading-relaxed md:leading-relaxed">
            
<h3 id="intro">Intro</h3>
<p>
  Recently, I was working with a customer that wanted to 
  extract the TCP SYN unanswered in/out metric captured by Extrahop 
  for a group of web servers, and send that data to Splunk for 
  their application team to view in a Splunk dashboard.
</p>
<p>
  It was an interesting problem to solve that highlights some 
  of the programmability that is available on-box in the ExtraHop 
  platform.
</p>
<p>
  In this post, I will show you how to access Metrics via 
  Bridge based Triggers within the ExtraHop platform and 
  send that data to Splunk. 
</p>

<h3 id="what-are-bridge-triggers-anyway">What Are Bridge Triggers Anyway?</h3>
<p>
  To understand Bridge Triggers, first lets find out 
  what a
    <a class="text-sky-600 no-underline hover:text-sky-800" href="https://docs.extrahop.com/current/triggers-overview/" target=_blank>Trigger</a> is.
</p>

<p>
  ExtraHop exposes the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">trigger</span>
  API that allows you to write on-box Javascript code to access, 
  store, and visualise wire data events and metrics that are 
  specific to your business requirements.
</p>


<p>
  This data can be stored as custom metrics, used to build 
  dashboards, and sent to external systems (such as Splunk) via 
  <a class="text-sky-600 no-underline hover:text-sky-800" href="https://docs.extrahop.com/current/open-data-streams/" target=_blank>Open Data Stream (ODS)</a>. 
    It's really powerful stuff.
</p>

 
<p>
  The main difference between a standard Trigger and a 
  Bridge Trigger is that:
</p>
  <ul>
    <li>
      <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Triggers</span> execute on 
      <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">events</span> during the 
      <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">wire data capture</span>.
    </li>
    <li>
      <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Bridge Triggers</span> execute 
      when a <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Metric</span> is computed 
      and <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">commited to the datastore</span>.
    </li>
  </ul> 


<!-- NOTE BLOCK START -->
<div id="note-block" class="pt-2 pb-4">
  <div class="shadow-md shadow-zinc-400 bg-sky-100 rounded border-l-8 border-l-sky-900 dark:border-l-sky-600 dark:bg-sky-800 dark:shadow-none">
    <div class="px-4 pt-4 pb-2 text-sky-900 dark:text-zinc-900"><i class="far fa-check-circle" aria-hidden="true"></i><b class="pl-1.5">Note</b></div>
    <div class="px-4 pb-4 dark:text-zinc-900">
    <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Bridge Triggers</span> are also known as <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Datastore Triggers</span>.
</div>
  </div>
</div>
<!-- NOTE BLOCK END -->



<h3 id="metric-catalog">Metric Catalog</h3>
<p>
  To find the details of the Metric we are interested in
  we can search for it in the Metric Catalog. In my case I am looking 
  for <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">TCP - Unanswered SYNs In/Out</span>.
  Lets browse to:
</p>


<!-- BREADCRUMBS START -->
<div id="breadcrumbs" class="pb-2 font-mono font-bold text-xl tracking-tight">
  <nav class="rounded px-3 py-2 w-fit bg-zinc-200 shadow-md shadow-zinc-400 dark:bg-zinc-900 dark:shadow-inner dark:shadow-black">
    <ol class="list-none py-0 pl-0 flex flex-wrap">
      
        <li class="text-sky-600 dark:text-sky-800">System Settings (<i class="fas fa-cog"></i>)</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Metrics & Records</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Metric Catalog</li>
        
      
    </ol>
  </nav>
</div>
<!-- BREADCRUMBS END -->



<p>
  Now search for <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">unanswered</span> in the 
  search box and select the 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">TCP - Unanswered SYNs In</span> Metric.
</p>


<!-- IMAGE START -->
<div class="pt-4 pb-6 flex justify-center">
  <img class="bg-white rounded-lg shadow-md shadow-zinc-400 dark:opacity-80 dark:shadow-none" 
    width="600px" 
    src="/img/blog/extrahop-bridge-triggers/metric-search.png" alt="blog/extrahop-bridge-triggers/metric-search.png">
</div>
<!-- IMAGE END -->


<p> 
  In the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Edit Metric</span> panel on the right, under 
  the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">REST API Parameters</span>, we can see the details 
  we need to look for in the Trigger.
</p>


<!-- IMAGE START -->
<div class="pt-4 pb-6 flex justify-center">
  <img class="bg-white rounded-lg shadow-md shadow-zinc-400 dark:opacity-80 dark:shadow-none" 
    width="600px" 
    src="/img/blog/extrahop-bridge-triggers/metric-details.png" alt="blog/extrahop-bridge-triggers/metric-details.png">
</div>
<!-- IMAGE END -->


<p>
  This tells me that I can find 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">syn_unanswered_in</span> in the  
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">object_type</span> of 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">device</span> in the 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">metric_category</span> of 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">tcp</span>. Take note of this info,
  we will need it in a future step. 
</p>
<p>
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">syn_unanswered_out</span> also 
  lives in the same <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">object_type</span>
  / <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">metric_category</span>.
</p>


<h3 id="bridge-trigger">Bridge Trigger</h3>
<p>
  Now that we have the Metric information we need, lets create a 
  Trigger. Browse to:
</p>


<!-- BREADCRUMBS START -->
<div id="breadcrumbs" class="pb-2 font-mono font-bold text-xl tracking-tight">
  <nav class="rounded px-3 py-2 w-fit bg-zinc-200 shadow-md shadow-zinc-400 dark:bg-zinc-900 dark:shadow-inner dark:shadow-black">
    <ol class="list-none py-0 pl-0 flex flex-wrap">
      
        <li class="text-sky-600 dark:text-sky-800">System Settings (<i class="fas fa-cog"></i>)</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Triggers</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Create</li>
        
      
    </ol>
  </nav>
</div>
<!-- BREADCRUMBS END -->


<p>
  The <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Events</span> type is 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">METRIC_RECORD_COMMIT</span>. Under 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Show Advanced Options</span>, you will see 
  that the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Metric types</span> are of 
  the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Datastore</span> type.
</p>
<p>
  Enter <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">extrahop.device.tcp</span> 
  as the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Metric Type</span> which 
  maps to the information we gathered earlier from the Metric 
  Catalog. Also, set the <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Metric cycle</span> to
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">30sec</span>. The 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Metric cycle</span> defines the time 
  period in which the Metrics SUM is calculated and written to 
  the datastore.
</p>

<!-- IMAGE START -->
<div class="pt-4 pb-6 flex justify-center">
  <img class="bg-white rounded-lg shadow-md shadow-zinc-400 dark:opacity-80 dark:shadow-none" 
    width="600px" 
    src="/img/blog/extrahop-bridge-triggers/bridge-trigger-create.png" alt="blog/extrahop-bridge-triggers/bridge-trigger-create.png">
</div>
<!-- IMAGE END -->


<h3 id="trigger-code">Trigger Code</h3>
<p>
  Now for the fun part. Trigger are written in 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">Javascript</span> and have 
  access to the exposed Trigger API. 
</p>
<p>
  I only want to collect the metrics for a subset of devices 
  and send them off to Splunk. Bridge triggers cannot be 
  assigned to a device group so, I will create an array; 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">devicesOfInterest</span>
  to hold the ID's of the devices I am interested in.
</p>

<p>
  The device ID can be found under:
</p>


<!-- BREADCRUMBS START -->
<div id="breadcrumbs" class="pb-2 font-mono font-bold text-xl tracking-tight">
  <nav class="rounded px-3 py-2 w-fit bg-zinc-200 shadow-md shadow-zinc-400 dark:bg-zinc-900 dark:shadow-inner dark:shadow-black">
    <ol class="list-none py-0 pl-0 flex flex-wrap">
      
        <li class="text-sky-600 dark:text-sky-800">Assets</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Devices</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Active Devices</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">&lt;device-name&gt;</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Edit Properties</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">API Properties</li>
        
          <li><span class="mx-2 font-extrabold text-zinc-800 dark:text-inherit">&gt;</span></li>
        
      
        <li class="text-sky-600 dark:text-sky-800">Discovery ID</li>
        
      
    </ol>
  </nav>
</div>
<!-- BREADCRUMBS END -->



<p>
  We want to capture the 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">syn_unanswered_in/out</span> 
  fields which are stored on the 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">MetricRecord.fields</span> 
  property. We know these are the fields we are looking for 
  because we found that information in the Metric Catalog 
  from a previous step.
</p>

<p>
  The Trigger code below captures the data we are looking for 
  and sends it off to Splunk. Follow along with the code comments 
  for details.
</p>

<!-- CODE BLOCK START -->
<div id="code-block" class="pt-2 pb-4">
  <div class="rounded-lg border-4 border-zinc-900 shadow-md shadow-zinc-400 dark:shadow-none">
    <div class="py-1 text-center font-bold font-mono border-b-4 border-zinc-900">
      <span class="">javascript</span>
    </div>
    <div class="font-mono">
      <pre><code class="language-javascript hljs px-5 dark:opacity-80 rounded-b">// Array of devices to capture metrics for.
let devicesOfInterest = [
    "aabbcc1122330000", // Test server
    // ... The rest of the servers in the group
]
// MetricRecord.object.id is the ID that ExtraHop uses for a discovered device.
// Continue if "MetricRecord.object.id" is in our "devicesOfInterest" array.
if (devicesOfInterest.includes(MetricRecord.object.id)) {
    
    // Build a record that Splunk can parse that contains:
    //  - The server IP.
    //  - The total tcp_syn_unanswered_in/out events per time interval.
    let splunk_log = `\
extrahop_event=tcp_syn_unanswered \
server_ip=${MetricRecord.object.ipaddrs[0]} \
tcp_syn_unanswered_in=${MetricRecord.fields["syn_unanswered_in"]} \
tcp_syn_unanswered_out=${MetricRecord.fields["syn_unanswered_out"]}`
    // Send log message to Splunk with a log level of "info".
    Remote.Syslog("ods_splunk_target").info(splunk_log);
}</code></pre>
    </div>
  </div>
</div>
<!-- CODE BLOCK END -->




<!-- NOTE BLOCK START -->
<div id="note-block" class="pt-2 pb-4">
  <div class="shadow-md shadow-zinc-400 bg-sky-100 rounded border-l-8 border-l-sky-900 dark:border-l-sky-600 dark:bg-sky-800 dark:shadow-none">
    <div class="px-4 pt-4 pb-2 text-sky-900 dark:text-zinc-900"><i class="far fa-check-circle" aria-hidden="true"></i><b class="pl-1.5">Note</b></div>
    <div class="px-4 pb-4 dark:text-zinc-900">
    A <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">debug()</span> statement can be used to get an array of all 
    <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">fields</span> that are available for a <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">MetricRecord</span> EG: <span class="px-2 py-1 font-mono font-semibold rounded bg-zinc-900 border border-zinc-800 text-emerald-400 dark:text-emerald-700">debug(Object.keys(MetricRecord.fields))</span>
</div>
  </div>
</div>
<!-- NOTE BLOCK END -->


<p>
  And there you have it! In a few lines of code, 
  we managed to capture the number of 
  <span class="px-2 py-1 font-mono font-semibold rounded bg-sky-50 text-sky-900 border border-sky-200/50 dark:bg-zinc-900 dark:text-neutral-400 dark:border-zinc-800">TCP SYN Unanswerd In/Outbound</span> 
  events for a group of hosts in a 30 second window, 
  and send it off to Splunk via ODS as a Syslog formatted message.
</p>

<p>
  To round this post out, feast your eyes on the Splunk log 
  which contains the details sent from the ExtraHop Trigger and becomes 
  indexed and searchable in Splunk which can also be used in dashboards.
</p>

<!-- IMAGE START -->
<div class="pt-4 pb-6 flex justify-center">
  <img class="bg-white rounded-lg shadow-md shadow-zinc-400 dark:opacity-80 dark:shadow-none" 
    width="600px" 
    src="/img/blog/extrahop-bridge-triggers/splunk-log.png" alt="blog/extrahop-bridge-triggers/splunk-log.png">
</div>
<!-- IMAGE END -->



<h3 id="outro">Outro</h3>
<p>
  In this post, I showed you how to utilise ExtraHop Bridge 
  (Datastore) Triggers to capture Metric data and send the data 
  off to Splunk as a syslog message via ODS.
</p>


            
  


            
  


            
  
    
  <!-- LINKS START -->
  <div class="pb-2">
    <h3 id="links">Links</h3>
      
        <p class="text-xl">
          <a class="text-sky-600 no-underline hover:text-sky-800" href="https://forums.extrahop.com/t/using-metricrecord-in-triggers/2639" target=_blank>https://forums.extrahop.com/t/using-metricrecord-in-triggers/2639</a>
        </p>
      
        <p class="text-xl">
          <a class="text-sky-600 no-underline hover:text-sky-800" href="https://docs.extrahop.com/current/triggers-overview/" target=_blank>https://docs.extrahop.com/current/triggers-overview/</a>
        </p>
      
        <p class="text-xl">
          <a class="text-sky-600 no-underline hover:text-sky-800" href="https://docs.extrahop.com/current/open-data-streams/" target=_blank>https://docs.extrahop.com/current/open-data-streams/</a>
        </p>
      
  </div>
  <!-- LINKS END -->

  


            
  
    
<!-- TAGS START -->
  <div id="tags" class="pb-2">
    <div class="flex justify-center">
      
        <div class="pr-2 text-rose-700 hover:text-rose-900 font-semibold italic lowercase tracking-wide">
          <i class="-mr-1.5 text-2xl">#</i>
          <a href="/blog/tag/#extrahop" class="text-xl">extrahop</a>        
        </div>
      
        <div class=" text-rose-700 hover:text-rose-900 font-semibold italic lowercase tracking-wide">
          <i class="-mr-1.5 text-2xl">#</i>
          <a href="/blog/tag/#splunk" class="text-xl">splunk</a>        
        </div>
      
    </div>
  </div>
<!-- TAGS END -->

  


            
  
<!-- BLANK PAGE START -->
<div id="blank-page">
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
    <br>
  
</div>
<!-- BLANK PAGE END -->


          </div>
        </div>
        <!-- COLUMN 2 END -->

        <!-- COLUMN 3 START -->
        <div class="invisible md:visible md:col-span-3 max-h-screen sticky top-20">
          
  
    
<!-- TABLE OF CONTENTS START -->
<div id="table-of-contents" class="invisible md:visible h-4/5 overflow-y-auto">
  <div class="">
    <h5 class="">On this page</h5>
  </div>
  <div class="">
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#intro">
            Intro
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#what-are-bridge-triggers-anyway">
            What Are Bridge Triggers Anyway
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#metric-catalog">
            Metric Catalog
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#bridge-trigger">
            Bridge Trigger
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#trigger-code">
            Trigger Code
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#outro">
            Outro
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#links">
            Links
          </a>
        </div>
      
    
      
        <div class="px-1">
          <a class="text-sky-600 font-normal text-xl no-underline hover:text-sky-800" href="#tags">
            Tags
          </a>
        </div>
      
      
  </div>
</div>
<!-- TABLE OF CONTENTS END -->

  

        </div>
        <!-- COLUMN 3 END -->

      </div>
      <!-- CONTENT END -->

      <!-- BACK TO TOP START -->
<div id="back-to-top" class="hidden fixed bottom-20 right-16 rounded-full font-semibold text-zinc-900 bg-neutral-400 hover:bg-neutral-100">
  <button type="button" class="">
    <i class="fas fa-arrow-circle-up fa-3x"></i>
  </button>
</div>
<!-- BACK TO TOP END -->
    </div>
  
    <!-- FOOTER START -->
<div id="footer" class="fixed inset-x-0 bottom-0">
  <div class="flex justify-center w-full py-4 bg-zinc-900 shadow-lg">
    <div class="text-center">
      <a class="px-2 font-semibold text-neutral-400 hover:text-neutral-100" href="https://twitter.com/codingpackets" target="_blank"><i class="fab fa-twitter fa-2x"></i></a>
      <a class="px-2 font-semibold text-neutral-400 hover:text-neutral-100" href="https://www.twitch.tv/codingpackets" target="_blank"><i class="fab fa-twitch fa-2x"></i></a>
      <a class="px-2 font-semibold text-neutral-400 hover:text-neutral-100" href="https://github.com/bwks" target="_blank"><i class="fab fa-github fa-2x"></i></a>
      <a class="px-2 font-semibold text-neutral-400 hover:text-neutral-100" href="/blog/feed.xml" target="_blank"><i class="fa fa-rss fa-2x"></i></a>
    </div>
  </div>
</div>
<!-- FOOTER END -->

  </body>

</html>
