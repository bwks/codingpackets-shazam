{% extends "_layouts/blog.jinja" %}

{% block page_content %}

<h3 id="intro">Intro</h3>
<p> 
  {{ link::e(path="https://stimulus.hotwire.dev/", description="Stimulus JS") }}
 is 
  a "A modest JavaScript framework for the HTML you already have."
  The aim of the project is to sprinkle your webapp with 
  Javascript to load dynamic content as opposed to building your 
  entire frontent with JS.
</p>
<p>
  In this post I will cover the process of installing and 
  getting started with StimulusJS in a Rails 6 app.
</p>

<h3 id="software-used">Software Used</h3>
<p>
  The following software was used in this post.
</p>
<ul>
  <li>Rails - 6.0.3.4</li>
  <li>Stimulus - 2.0.0</li>
</ul>

<h3 id="installation">Installation</h3>
<p>
  Install Stimulus with the 
  {{ text::code(text="bundle exec rails webpacker:install:stimulus") }}
 command.
</p>
{{ text::code_block(
  header="cmd",
  language="text",
  code='bundle exec rails webpacker:install:stimulus

# output 

Installing all Stimulus dependencies
         run  yarn add stimulus from "."
yarn add v1.22.5
[1/4] Resolving packages...
[2/4] Fetching packages...
info fsevents@2.1.3: The platform "linux" is incompatible with this module.
info "fsevents@2.1.3" is an optional dependency and failed compatibility check. Excluding it from installation.
info fsevents@1.2.13: The platform "linux" is incompatible with this module.
info "fsevents@1.2.13" is an optional dependency and failed compatibility check. Excluding it from installation.
[3/4] Linking dependencies...
warning " > webpack-dev-server@3.11.0" has unmet peer dependency "webpack@^4.0.0 || ^5.0.0".
warning "webpack-dev-server > webpack-dev-middleware@3.7.2" has unmet peer dependency "webpack@^4.0.0".
[4/4] Building fresh packages...
success Saved lockfile.
success Saved 5 new dependencies.
info Direct dependencies
â””â”€ stimulus@2.0.0
info All dependencies
â”œâ”€ @stimulus/core@2.0.0
â”œâ”€ @stimulus/multimap@2.0.0
â”œâ”€ @stimulus/mutation-observers@2.0.0
â”œâ”€ @stimulus/webpack-helpers@2.0.0
â””â”€ stimulus@2.0.0
Done in 4.08s.
Webpacker now supports Stimulus.js ðŸŽ‰'
) }}

<p>
  This will install Stimulus and also in typical rails fashion 
  the following boilerplate files/folders will be created.
</p>
<ul>
  <li>app/javascript/controllers</li>
  <li>app/javascript/controllers/hello_controller.js</li>
  <li>app/javascript/controllers/index.js</li>
</ul>

<h3 id="usage">Usage</h3>
<p>
  I will use the example code from the Stimuls website 
  for the next section.
</p>
<p>
  At the time of writing the code for the 
  {{ text::emphasize(text="hello_controller.js") }}

  file generated by the install process was not compatible 
  with the example code from the website. 
</p>
<p>
  Change the file to the following contents.
</p>
{{ text::code_block(
  header="file",
  language="javascript",
  code=' # app/javascript/controllers/hello_controller.js

import { Controller } from "stimulus"

export default class extends Controller {
  static targets = [ "name", "output" ]

  greet() {
    this.outputTarget.textContent =
      `Hello, ${this.nameTarget.value}!`
  }
}'
) }}

<p>
  In some view add the following example content.
</p>
{{ text::code_block(
  header="file",
  language="javascript",
  code=' # app/views/examples/index.html.erb

&lt;!--HTML from anywhere--&gt;
&lt;div data-controller="hello"&gt;
  &lt;input data-hello-target="name" type="text"&gt;

  &lt;button data-action="click-&gt;hello#greet"&gt;
    Greet
  &lt;/button&gt;

  &lt;span data-hello-target="output"&gt;
  &lt;/span&gt;
&lt;/div&gt;'
) }}

<p>
  This will create an input like the below.
</p>
<!--HTML from anywhere-->
<div data-controller="hello">
  <input data-hello-target="name" type="text">

  <button data-action="click->hello#greet">
    Greet
  </button>

  <span data-hello-target="output">
  </span>

</div>

<p>
  Type something in the box and press the 
  {{ text::emphasize(text="Greet") }}

  button.
</p>

<p>
  If everything is setup correctly you will see 
  some output next to the input box.
</p>
<p>
  If not, open the inspector console in your browser
  and check for any errors. 
</p>

<h3 id="outro">Outro</h3>
<p>
  In this post I covered the process of installing and using 
  Stimulus JS in a Rails 6 application. Do you feel stimulated?
  I know I do!
</p>
{% endblock page_content %}
