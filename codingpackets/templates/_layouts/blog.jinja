{% extends "_layouts/site.jinja" %}

{% block page_header %}
  {% if post %}
    {{ text::header(heading=post.title, published_date=post.published_date, updated_date=post.updated_date) }}
  {% elif posts %}
    {{ text::header(heading="Stuff and Things Blog") }}
  {% endif %}
{% endblock page_header %}

{% block page_content %}
  
  {% for category, posts in posts.by_category %}
    {% if category and category != "uncategorised" %}
      <div class="pb-4" id="{{ category | slugify }}">
        <div class="text-center bg-zinc-900 border-4 border-zinc-900 rounded-t-lg">
          <h3 class="pt-0 pb-1 text-2xl font-normal text-neutral-100 dark:text-neutral-400">{{ category | slugify }}</h3>
        </div>
        {% for post in posts %}
          {% if post.publish %}
            <div class="block py-2 px-4 shadow-lg border-4 border-zinc-900 {% if not loop.last %}border-b-0 rounded-b-none{% else %}rounded-b-lg{% endif %}">
              <div class="">
                <a class="text-sky-600 font-semibold text-2xl no-underline hover:text-sky-800" href="/blog/{{ post.title | slugify }}">{{ post.title | title_case }}</a>
                <p class="font-medium text-xl">
                  {{ post.description }}
                </p>
              </div>

              {% include "_includes/dates.jinja" %}
              {{ text::tag_block(tags=post.tags) }}

            </div>
          {% endif %}
        {% endfor %}      
      </div>
    {% endif %}
  {% endfor %}

{% endblock page_content %}

{% block page_tags %}
  {% if post and post.tags | length > 0 %}
    {{ text::tag_block(tags=post.tags, center=true) }}
  {% endif %}
{% endblock page_tags %}

{% block blank_page %}
  {{ spacer::blank_page(end=35) }}
{% endblock blank_page %}

{% block page_toc %}
  {% if post and post.table_of_contents | length > 0 %}
    {{ table::toc(header="On this page", rows=post.table_of_contents) }}
  {% elif not post and posts %}
    {{ table::toc(header="Categories", rows=posts.categories, slug=true) }}
  {% endif %}
{% endblock page_toc %}